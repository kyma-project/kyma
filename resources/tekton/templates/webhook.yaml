---
apiVersion: v1
kind: Service
metadata:
    labels:
        app: tekton-pipelines-webhook
    name: tekton-pipelines-webhook
    namespace: tekton-pipelines
spec:
    ports:
        - port: 443
          targetPort: 8443
    selector:
        app: tekton-pipelines-webhook
---
apiVersion: apps/v1
kind: Deployment
metadata:
    labels:
        app.kubernetes.io/component: webhook-controller
        app.kubernetes.io/name: tekton-pipelines
    name: tekton-pipelines-webhook
    namespace: tekton-pipelines
spec:
    replicas: 1
    selector:
        matchLabels:
            app: tekton-pipelines-webhook
    template:
        metadata:
            annotations:
                cluster-autoscaler.kubernetes.io/safe-to-evict: "false"
            labels:
                app: tekton-pipelines-webhook
                app.kubernetes.io/component: webhook-controller
                app.kubernetes.io/name: tekton-pipelines
        spec:
            containers:
                - env:
                      - name: SYSTEM_NAMESPACE
                        valueFrom:
                            fieldRef:
                                fieldPath: metadata.namespace
                  image: gcr.io/tekton-releases/github.com/tektoncd/pipeline/cmd/webhook@sha256:7215a25a58c074bbe30a50db93e6a47d2eb5672f9af7570a4e4ab75e50329131
                  name: webhook
                  volumeMounts:
                      - mountPath: /etc/config-logging
                        name: config-logging
            serviceAccountName: tekton-pipelines-controller
            volumes:
                - configMap:
                      name: config-logging
                  name: config-logging
---
