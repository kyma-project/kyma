apiVersion: v1
kind: ConfigMap
metadata:
  name: logging-dashboard
  labels:
    grafana_dashboard: "1"
    app: monitoring-grafana
data:
  logging-dashboard.json: |-
    {"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"}]},"description":"Monitoring for logging","editable":true,"graphTooltip":1,"id":30,"links":[],"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus","description":"Shows data throughput rate in KB/s","fill":1,"gridPos":{"h":9,"w":12,"x":0,"y":0},"id":2,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"sort":null,"sortDesc":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"rate(loki_distributor_bytes_received_total[1m])/1024","format":"time_series","hide":false,"instant":false,"interval":"1m","intervalFactor":1,"legendFormat":"kilobytes/sec","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Loki push Kb/sec","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"KBs","label":"","logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"requests/sec":"blue"},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus","description":"","fill":1,"gridPos":{"h":9,"w":12,"x":12,"y":0},"id":7,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(loki_request_duration_seconds_sum[1m]))","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"requests/sec","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Loki Queries/sec","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"reqps","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":9,"w":24,"x":0,"y":9},"id":3,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"lag","yaxis":2}],"stack":false,"steppedLine":false,"targets":[{"expr":"sum (rate(promtail_read_bytes_total[5m]))","format":"time_series","hide":false,"intervalFactor":1,"legendFormat":"read","refId":"B"},{"expr":"sum (rate(promtail_sent_bytes_total[5m]))","format":"time_series","hide":false,"intervalFactor":1,"legendFormat":"sent","refId":"C"},{"expr":"sum (rate(promtail_encoded_bytes_total[5m]))","format":"time_series","hide":false,"intervalFactor":1,"legendFormat":"encoded","refId":"D"},{"expr":"sum(promtail_file_bytes_total - promtail_read_bytes_total)","format":"time_series","intervalFactor":1,"legendFormat":"lag","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Promtail","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":24,"x":0,"y":18},"id":5,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"sideWidth":null,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"promtail_file_bytes_total - promtail_read_bytes_total > 100000","format":"time_series","hide":false,"interval":"","intervalFactor":1,"legendFormat":"{{"{{"}}path}}","refId":"A"},{"expr":"promtail_file_bytes_total - promtail_read_bytes_total < -100000","format":"time_series","hide":true,"intervalFactor":1,"legendFormat":"{{"{{"}}path}}","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Lag","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":false,"schemaVersion":18,"style":"dark","tags":[],"templating":{"list":[]},"time":{"from":"now-2h","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"Loki-Promtail","uid":"htcadXCiz","version":1}