apiVersion: kubeless.io/v1beta1
kind: Function
metadata:
  annotations:
    function-size: L
  name: test
  namespace: stage
spec:
  deployment:
    spec:
      replicas: 5
      strategy: {}
      template:
        spec:
          containers:
          - name: test
            resources:
              limits:
                cpu: "1"
                memory: 512Mi
              requests:
                cpu: 100m
                memory: 100Mi
  function: |-
    module.exports = { main: function (event, context) {
        return "call to test function!"
    } }
  function-content-type: text
  handler: handler.main
  horizontalPodAutoscaler:
    metadata:
      labels:
        function: test
      name: test
      namespace: qa
    spec:
      maxReplicas: 10
      metrics:
      - resource:
          name: cpu
          targetAverageUtilization: 40
        type: Resource
      minReplicas: 5
      scaleTargetRef:
        apiVersion: apps/v1beta1
        kind: Deployment
        name: test
  runtime: nodejs8
  service:
    ports:
    - name: http-function-port
      port: 8080
      protocol: TCP
      targetPort: 8080
    selector:
      created-by: kubeless
      function: test
