apiVersion: kubeless.io/v1beta1
kind: Function
metadata:
  annotations:
    function-size: S
  name: size-s
spec:
  handler: handler.main
  runtime: nodejs8
  type: HTTP
  deployment:
    spec:
      template:
        spec:
          containers:
          - name: $FUNC_NAME
            resources:
              limits:
                cpu: 100m
                memory: 128Mi
              requests:
                cpu: 100m
                memory: 100Mi
  function: |
    module.exports = {
      main: (event, context) => {
        return 'hello world';
      }
    };
---
apiVersion: gateway.kyma-project.io/v1alpha2
kind: Api
metadata:
  labels:
    function: size-s
  name: size-s
spec:
  authentication: []
  hostname: size-s.$CLUSTER_DOMAIN_NAME
  service:
    name: size-s
    port: 8080
---
apiVersion: autoscaling/v1
kind: HorizontalPodAutoscaler
metadata:
  labels:
    function: size-s
  name: size-s
spec:
  maxReplicas: 2
  minReplicas: 1
  scaleTargetRef:
    apiVersion: apps/v1beta1
    kind: Deployment
    name: size-s
  targetCPUUtilizationPercentage: 50